# 1. Цель проекта

Цель проекта - создать удобный сервис для авторов тг каналов (далее "Сервис"). Автор сможет управлять тегами к постам; настраивать шаблон поста, шаблон репоста/поста из предложки.

# 2. Описание сервиса

Сервис будет включать следующие функциональные блоки:
1. Регистрация, аутентификация и авторизация.
2. Функционал Автора. <br>
2.1 Функционал управления шаблонами. <br>
2.2 Функционал публикации постов в формате шаблона.
3. Функционал Подписчика. <br>
3.1 Функционал предложенных постов от подписчиков (далее "Предложка").

## 2.1. Типы пользователей

Прежде, чем рассматривать регистрацию, аутентификацию и авторизацию, нужно определиться с типами пользователей.
Всего будет два пользователя:
- Подписчик - обычный пользователь, который может предлагать посты.
- Автор - пользователь, который выкладывает свои посты, создаёт шаблоны постов и публикуют посты из предложки.

## 2.2. Регистрация

Сервис имеет тип распространения PaaS (Platform as a Service), и это значит, что данный продукт будет привязываться к какому-то конкретному телеграмм-каналу, а в частности к автору.
Любой автор сможет развернуть Сервис на своих машинах, т.к. он предоставляется бесплатно и имеет открытый исходный код.

Процесс регистрации автора в Системе, будет происходить из командной строки, а именно команды запуска Сервиса, в аргументы которой должен быть передан id телеграмм аккаунта Автора.

Процесс регистрации Подписчика будет происходить через телеграмм бота, который будет сохранять информацию об аккаунте пользователя в Б/Д, тем самым регистрируя его в Системе.
Желательно предусмотреть проверку по наличию номера телефона пользователя у аккаунта, чтобы снизить любые атаки на Предложку к минимуму.

## 2.3. Аутентификация пользователей

Аутентификация Автора и Подписчиков осуществляется по id телеграмм аккаунта пользователя.
Нужно предусмотреть возможность смены id телеграмм аккаунта у автора через командную строку.

## 2.4. Функционал Автора

Автор имеет следующие возможности:
1. Создавать, редактировать, добавлять и удалять шаблоны для постов.
2. Добавлять теги постов
3. Создавать посты, пересылать посты, статьи и другое, убирать ссылку на оригинал, ставить посты в очередь, публиковать посты внеочереди, редактировать неопубликованные посты, прикреплять к постам существующие теги.
4. Публиковать, редактировать, отколнять посты из Предложки и прикреплять к ним существующие теги.

## 2.5 Функционал Подписичика

Подписчик имеет следующие возможности:
1. Предалагать новость, пост и прочее
2. Получать уведомление об изменении статусе предложенного поста.
3. Удалиться из системы, оставив все предложенные посты.

# 3. Реализация Сервиса

Сервис будет использовать следующий технологический стек:
- Бекэнд
  - Язык Python
    - Библиотека для миграций Alembic
  - Б/Д PostgreSQL
- Фронтэнд:
  - Язык Python
    - Библиотека pyTelegramBotAPI

Таблицы в Б/Д:
<table style="margin-left: auto; margin-right: auto;">
  <tr><th>Пользователи</th></tr>
  <tr>
    <td>Телеграмм id (PKey, Unic)</td>
  </tr>
  <tr>
    <td>Имя пользователя (varchar255)</td>
  </tr>
  <tr>
    <td>Фамилия пользователя (varchar255)</td>
  </tr>
  <tr>
    <td>Телефон пользователя (decimal30,0)</td>
  </tr>
  <tr>
    <td>Ссылка на пользователя (varchar255)</td>
  </tr>
  <tr>
    <td>Автор ли (bool)</td>
  </tr>
</table>

----

<table style="margin-left: auto; margin-right: auto;">
  <tr><th>Посты</th></tr>
  <tr>
    <td>id (PKey, Unic)</td>
  </tr>
  <tr>
    <td>Авторский текст (Text)</td>
  </tr>
  <tr>
    <td>Когда опубликовать пост (timestamp)</td>
  </tr>
  <tr>
    <td>Репост ли (bool)</td>
  </tr>
  <tr>
    <td>Текст репоста (text | null)</td>
  </tr>
  <tr>
    <td>Автор репоста (varchar255 | null | int references users(id))</td>
  </tr>
  <tr>
    <td>Ссылка на репост (varchar255 | null | varchar255 references users(link))</td>
  </tr>
</table>

----

<table style="margin-left: auto; margin-right: auto;">
  <tr><th>Теги</th></tr>
  <tr>
    <td>id (PKey, Unic)</td>
  </tr>
  <tr>
    <td>Имя (varchar255)</td>
  </tr>
</table>

----

<table style="margin-left: auto; margin-right: auto;">
  <tr><th>Теги постов</th></tr>
  <tr>
    <td>id тега (int references tags(id))</td>
  </tr>
  <tr>
    <td>id поста (int references posts(id))</td>
  </tr>
 </table>

